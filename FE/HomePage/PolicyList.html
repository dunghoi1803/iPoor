<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iPOOR | Chính sách & Báo cáo</title>
    <link rel="icon" type="image/png" href="../Image/icon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --navy-900: #0f172a;
            --navy-800: #162544;
            --navy-700: #1f2f54;
            --blue-500: #3b82f6;
            --blue-300: #60a5fa;
            --blue-100: #e1ecff;
            --orange-400: #f59e0b;
            --gray-50: #f5f7fa;
            --gray-100: #e5e7eb;
            --gray-200: #e2e8f0;
            --gray-400: #94a3b8;
            --gray-500: #6b7280;
            --white: #ffffff;
            --card-shadow: 0 10px 30px rgba(15, 23, 42, 0.08);
            --tag-policy: #eef2ff;
            --tag-report: #ecfeff;
            --tag-guide: #fef9c3;
            --tag-other: #f4f4f5;
            --tag-news: #e0f2fe;
            --tag-announcement: #fee2e2;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Manrope', system-ui, -apple-system, sans-serif; background: var(--gray-50); color: var(--navy-900); }

        .app-shell { display: grid; grid-template-columns: 260px 1fr; min-height: 100vh; }
        .sidebar { background: var(--navy-900); color: var(--white); display: flex; flex-direction: column; padding: 20px 18px; }
        .brand { display: flex; align-items: center; gap: 12px; padding: 10px 12px 20px; }
        .brand-mark { width: 44px; height: 44px; border-radius: 12px; background: var(--white); display: grid; place-items: center; }
        .brand-logo { width: 30px; height: 30px; object-fit: contain; }
        .brand-name { font-size: 18px; font-weight: 700; letter-spacing: 0.4px; }

        nav { margin-top: 8px; display: grid; gap: 6px; }
        .nav-item { display: flex; align-items: center; gap: 12px; padding: 12px 14px; border-radius: 10px; color: var(--white); text-decoration: none; transition: background 0.2s, transform 0.1s; }
        .nav-item:hover { background: var(--navy-800); transform: translateX(2px); }
        .nav-item.active { background: var(--navy-700); border-left: 3px solid var(--blue-500); }
        .nav-icon { width: 16px; height: 16px; display: inline-flex; align-items: center; justify-content: center; }

        main { background: linear-gradient(135deg, #f8fbff 0%, #f4f5fb 100%); padding: 24px 28px; }
        .page-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; gap: 12px; }
        .title-block h1 { font-size: 26px; margin-bottom: 6px; }
        .title-block p { color: var(--gray-500); }

        .filter-bar { background: var(--white); border: 1px solid var(--gray-100); border-radius: 14px; padding: 14px 16px; box-shadow: var(--card-shadow); display: grid; grid-template-columns: 220px 1fr 200px; gap: 12px; align-items: center; }
        .select { padding: 10px 12px; border-radius: 10px; border: 1px solid var(--gray-100); background: var(--white); font-weight: 600; color: var(--navy-900); width: 100%; }
        .search-box { position: relative; }
        .search-box input { width: 100%; padding: 10px 12px 10px 36px; border-radius: 10px; border: 1px solid var(--gray-100); font-weight: 600; }
        .search-box svg { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--gray-400); }

        .btn-primary { padding: 11px 16px; border-radius: 10px; background: linear-gradient(90deg, var(--blue-500), var(--blue-300)); color: var(--white); border: none; font-weight: 700; cursor: pointer; box-shadow: 0 12px 22px rgba(59, 130, 246, 0.3); transition: transform 0.1s ease; justify-self: end; }
        .btn-primary:hover { transform: translateY(-1px); }

        .list { margin-top: 18px; display: grid; gap: 12px; }
        .card { background: var(--white); border: 1px solid var(--gray-100); border-radius: 16px; padding: 16px; box-shadow: var(--card-shadow); display: grid; gap: 10px; }
        .card-header { display: flex; justify-content: space-between; align-items: flex-start; gap: 12px; }
        .card-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--navy-900);
            text-decoration: none;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .meta { display: flex; gap: 12px; flex-wrap: wrap; color: var(--gray-500); font-size: 14px; margin-top: 4px; }
        .tag { padding: 6px 10px; border-radius: 999px; font-weight: 700; font-size: 12px; display: inline-flex; align-items: center; gap: 6px; }
        .tag.policy { background: var(--tag-policy); color: #4338ca; }
        .tag.report { background: var(--tag-report); color: #0ea5e9; }
        .tag.guide { background: var(--tag-guide); color: #a16207; }
        .tag.other { background: var(--tag-other); color: #52525b; }
        .tag.news { background: var(--tag-news); color: #0369a1; }
        .tag.announcement { background: var(--tag-announcement); color: #b91c1c; }
        .card-desc { color: var(--gray-500); line-height: 1.6; }
        .card-actions { display: flex; align-items: center; gap: 10px; }
        .pdf { display: inline-flex; align-items: center; gap: 6px; padding: 8px 10px; border-radius: 10px; background: #fff7ed; border: 1px solid #fed7aa; color: #ea580c; font-weight: 700; text-decoration: none; }
        .pdf svg { color: #f97316; }
        .link { text-decoration: none; font-weight: 700; color: var(--blue-500); white-space: nowrap; }

        @media (max-width: 1024px) {
            .app-shell { grid-template-columns: 1fr; }
            .sidebar { flex-direction: row; overflow-x: auto; height: 72px; }
            nav { grid-auto-flow: column; grid-auto-columns: max-content; align-items: center; }
            .filter-bar { grid-template-columns: 1fr; }
            .btn-primary { justify-self: start; width: fit-content; }
        }
            .menu-toggle {
            margin-left: auto;
            width: 36px;
            height: 36px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.35);
            background: transparent;
            color: var(--white);
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        .menu-toggle svg { width: 18px; height: 18px; }

        @media (max-width: 1024px) {
            .app-shell { grid-template-columns: 72px 1fr; }
            .sidebar { padding: 16px 10px; }
            .brand { justify-content: space-between; padding: 8px 6px 16px; }
            .brand-name { display: none; }
            .menu-toggle { display: inline-flex; }
            .nav-item { justify-content: center; }
            .nav-item .nav-text { display: none; }
            .sidebar.expanded { padding: 20px 18px; }
            .sidebar.expanded .brand-name { display: block; }
            .sidebar.expanded .nav-item { justify-content: flex-start; }
            .sidebar.expanded .nav-item .nav-text { display: inline; }
            .app-shell.menu-expanded { grid-template-columns: 240px 1fr; }
        }
        @media (max-width: 680px) {
            .app-shell { grid-template-columns: 72px 1fr; }
            .sidebar { flex-direction: column; height: auto; overflow: hidden; }
            nav { grid-auto-flow: row; }
        }
            @media (max-width: 1024px) {
            .app-shell { grid-template-columns: 72px 1fr; }
            .sidebar { flex-direction: column; overflow: hidden; height: auto; }
            nav { grid-auto-flow: row; grid-auto-columns: initial; align-items: stretch; }
        }
            @media (max-width: 1024px) {
            .brand { flex-direction: column; align-items: flex-start; gap: 8px; }
            .brand-mark { order: 1; }
            .menu-toggle { order: 2; align-self: flex-end; }
            .brand-name { order: 3; }
            .sidebar.expanded .brand { align-items: flex-start; }
        }
            @media (max-width: 1024px) {
            .sidebar.expanded .brand {
                flex-direction: row;
                flex-wrap: wrap;
                align-items: center;
                gap: 8px 12px;
            }
            .sidebar.expanded .brand-mark { order: 1; }
            .sidebar.expanded .brand-name { order: 2; display: block; }
            .sidebar.expanded .menu-toggle {
                order: 3;
                width: 100%;
                align-self: flex-start;
                margin-top: 8px;
            }
        }
            @media (max-width: 1024px) {
            .sidebar.expanded .brand { justify-content: flex-start; gap: 8px; }
            .sidebar.expanded .brand-name { margin-left: 0; }
            .sidebar.expanded .menu-toggle {
                width: 36px;
                height: 36px;
                border-radius: 8px;
                margin-top: 8px;
            }
        }
            @media (max-width: 1024px) {
            .nav-item .nav-text { display: none; }
            .sidebar.expanded .nav-item .nav-text { display: inline; }
        }
    </style>
</head>
<body>
<div class="app-shell">
    <aside class="sidebar">
        <div class="brand">
            <div class="brand-mark"><img class="brand-logo" src="../Image/icon.png" alt="Logo"></div>
            <div class="brand-name">iPOOR</div>
            <button class="menu-toggle" type="button" aria-label="Mở menu">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
                <nav>
            <a class="nav-item" href="../LandingPage/index.html">
                <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M2 7.5 8 2l6 5.5V14H9.5v-3h-3v3H2V7.5Z" fill="white" opacity="0.9"/>`</svg></span>
                <span class="nav-text">Trang giới thiệu</span>
            </a>
            <a class="nav-item" href="./HomePage.html">
                <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M8 2a6 6 0 0 0-6 6v2.5A1.5 1.5 0 0 0 3.5 12h9A1.5 1.5 0 0 0 14 10.5V8a6 6 0 0 0-6-6Z" stroke="white" stroke-width="1.3"/><path d="M8 8 10.8 6.2" stroke="white" stroke-width="1.3" stroke-linecap="round"/><circle cx="8" cy="8" r="1" fill="white"/>`</svg></span>
                <span class="nav-text">Dashboard</span>
            </a>
            <a class="nav-item" href="./HouseholdList.html">
                <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="2" y="3" width="12" height="10" rx="2" stroke="white" stroke-width="1.4"/><path d="M5 3v10" stroke="white" stroke-width="1.2" opacity="0.7"/><circle cx="11" cy="7" r="1" fill="white"/>`</svg></span>
                <span class="nav-text">Quản lý hộ nghèo</span>
            </a>
            <a class="nav-item" href="./DataCollection.html">
                <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M2.5 5.5h11v1.5h-11V5.5Zm0 3h7v1.5h-7V8.5Zm0 3h5v1.5h-5V11.5Z" fill="white" opacity="0.9"/><path d="M10.5 3v10" stroke="white" stroke-width="1.2" opacity="0.7"/>`</svg></span>
                <span class="nav-text">Thu thập & cập nhật dữ liệu</span>
            </a>
            <a class="nav-item active" href="./PolicyList.html">
                <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M3 13V3h10v10H3Z" stroke="white" stroke-width="1.3"/><path d="M5 6.5h6M5 9h3.5" stroke="white" stroke-width="1.2" stroke-linecap="round"/>`</svg></span>
                <span class="nav-text">Chính sách & báo cáo</span>
            </a>
            <a class="nav-item" href="./GISMap.html">
                <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M2.7 7.3c0-2.5 2-4.5 4.5-4.5s4.5 2 4.5 4.5-2 4.5-4.5 4.5c-.7 0-1.3-.15-1.9-.44l-2.05.58.55-1.95c-.36-.62-.6-1.34-.6-2.09Z" stroke="white" stroke-width="1.3"/><path d="M6.5 6.8c0-.7.6-1.2 1.2-1.2.7 0 1.2.5 1.2 1.2 0 .6-.5 1.2-1.2 1.2-.7 0-1.2-.6-1.2-1.2Z" fill="white"/>`</svg></span>
                <span class="nav-text">Bản đồ nghèo (GIS)</span>
            </a>
            <a class="nav-item" href="./ActivityLogs.html">
                <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M4.5 3.5h7m-7 9h7M8 1.5v2m0 9v2M5.5 6h5L9.8 10H6.2L5.5 6Z" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>`</svg></span>
                <span class="nav-text">Nhật ký hoạt động</span>
            </a>
        </nav>
    </aside>

    <main>
        <div class="page-header">
            <div class="title-block">
                <h1>Chính sách giảm nghèo &amp; Báo cáo</h1>
                <p>Tổng hợp chính sách mới, báo cáo, hướng dẫn triển khai chương trình giảm nghèo.</p>
            </div>
            <a class="btn-primary" href="./PolicyForm.html" role="button">+ Viết bài mới / Đăng báo cáo</a>
        </div>

        <div class="filter-bar">
            <select id="filter-type" class="select" aria-label="Chọn loại tài liệu">
                <option value="all">Tất cả loại tài liệu</option>
                <option value="policy">Chính sách</option>
                <option value="report">Báo cáo</option>
                <option value="guide">Hướng dẫn</option>
                <option value="news">Tin tức</option>
                <option value="announcement">Thông báo</option>
                <option value="other">Khác</option>
            </select>
            <div class="search-box">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="m21 21-4.35-4.35m1.35-5.4A7.5 7.5 0 1 1 6.6 6.6a7.5 7.5 0 0 1 11.4 0Z" stroke="#94a3b8" stroke-width="1.6" stroke-linecap="round"/></svg>
                <input id="search-input" type="text" placeholder="Tìm theo tiêu đề, từ khóa...">
            </div>
            <button id="filter-btn" class="btn-primary" type="button">Lọc</button>
        </div>

        <section class="list" id="list"></section>
    </main>
</div>

<script>
    const API_BASE_URL = sessionStorage.getItem('ipoor_api_base') || 'http://127.0.0.1:8000';
    const TOKEN_STORAGE_KEY = 'ipoor_access_token';
    const POLICY_SELECTED_KEY = 'ipoor_policy_selected_id';
    const POLICY_CACHE_KEY = 'ipoor_policy_cache';
    const SUMMARY_MAX_LENGTH = 180;
    const typeLabels = {
        decree: { text: 'Chính sách', cls: 'policy' },
        circular: { text: 'Chính sách', cls: 'policy' },
        policy: { text: 'Chính sách', cls: 'policy' },
        report: { text: 'Báo cáo', cls: 'report' },
        guideline: { text: 'Hướng dẫn', cls: 'guide' },
        guide: { text: 'Hướng dẫn', cls: 'guide' },
        news: { text: 'Tin tức', cls: 'news' },
        announcement: { text: 'Thông báo', cls: 'announcement' },
        other: { text: 'Khác', cls: 'other' },
    };

    const listEl = document.getElementById('list');
    const filterType = document.getElementById('filter-type');
    const searchInput = document.getElementById('search-input');
    const filterBtn = document.getElementById('filter-btn');
    const dropdownBtn = document.getElementById('accountDropdown');
    const dropdownMenu = document.getElementById('dropdownMenu');
    let policies = [];

    function render(items) {
        listEl.innerHTML = '';
        if (!items.length) {
            const empty = document.createElement('div');
            empty.textContent = 'Không có bài viết phù hợp.';
            empty.style.color = '#6b7280';
            listEl.appendChild(empty);
            return;
        }

        items.forEach(item => {
            const card = document.createElement('article');
            card.className = 'card';

            const header = document.createElement('div');
            header.className = 'card-header';

            const left = document.createElement('div');
            const titleLink = document.createElement('a');
            titleLink.href = `./PolicyDetail.html?id=${item.id || ''}`;
            titleLink.className = 'card-title policy-link';
            titleLink.dataset.id = item.id || '';
            titleLink.textContent = item.title;
            left.appendChild(titleLink);

            const meta = document.createElement('div');
            meta.className = 'meta';
            const type = document.createElement('span');
            const mapped = mapCategory(item.category || item.type || 'other');
            type.className = `tag ${mapped.cls}`;
            type.textContent = mapped.text;
            meta.appendChild(type);
            const dateSpan = document.createElement('span');
            dateSpan.textContent = `Ngày đăng: ${formatDate(item.updated_at || item.created_at)}`;
            const authorSpan = document.createElement('span');
            authorSpan.textContent = `Tác giả: ${item.issued_by || 'N/A'}`;
            meta.append(dateSpan, authorSpan);
            left.appendChild(meta);

            const actions = document.createElement('div');
            actions.className = 'card-actions';
            if (item.pdf) {
                const pdfLink = document.createElement('a');
                pdfLink.href = item.pdf;
                pdfLink.className = 'pdf';
                pdfLink.target = '_blank';
                pdfLink.rel = 'noopener';
                pdfLink.innerHTML = '<svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M4 2h6l3 3v9H4V2Z" stroke="#ea580c" stroke-width="1.2"/><path d="M10 2v3h3" stroke="#ea580c" stroke-width="1.2"/><path d="M5.5 9.5h1m3 0H11M8 9.5V13" stroke="#ea580c" stroke-width="1.1" stroke-linecap="round"/></svg>PDF';
                actions.appendChild(pdfLink);
            }
            const readLink = document.createElement('a');
            readLink.href = `./PolicyDetail.html?id=${item.id || ''}`;
            readLink.className = 'link policy-link';
            readLink.dataset.id = item.id || '';
            readLink.textContent = 'Xem chi tiết';
            actions.appendChild(readLink);

            header.appendChild(left);
            header.appendChild(actions);

            const desc = document.createElement('p');
            desc.className = 'card-desc';
            desc.textContent = getSummary(item.summary || item.description || '');

            card.appendChild(header);
            card.appendChild(desc);
            listEl.appendChild(card);
        });
    }

    function applyFilter() {
        const keyword = searchInput.value.trim().toLowerCase();
        const type = filterType.value;
        const filtered = policies.filter(item => {
            const cat = item.category || 'other';
            const matchType = type === 'all'
                || (type === 'policy' && (cat === 'decree' || cat === 'circular' || cat === 'policy'))
                || (type === 'guide' && (cat === 'guide' || cat === 'guideline'))
                || (type === 'news' && cat === 'news')
                || (type === 'announcement' && cat === 'announcement')
                || cat === type;
            const matchText = !keyword || (item.title || '').toLowerCase().includes(keyword) || (item.summary || item.description || '').toLowerCase().includes(keyword);
            return matchType && matchText;
        });
        render(filtered);
    }

    function getToken() {
        return localStorage.getItem(TOKEN_STORAGE_KEY) || sessionStorage.getItem(TOKEN_STORAGE_KEY);
    }

    function mapCategory(category) {
        return typeLabels[category] || typeLabels.other;
    }

    function normalizeAttachmentUrl(value) {
        if (!value) return '';
        if (value.startsWith('http://') || value.startsWith('https://')) return value;
        if (value.startsWith('/')) return `${API_BASE_URL}${value}`;
        return value;
    }

    function formatDate(value) {
        if (!value) return 'Chưa rõ ngày đăng';
        const d = new Date(value);
        return isNaN(d.getTime()) ? 'Chưa rõ ngày đăng' : d.toLocaleDateString('vi-VN');
    }

    function stripHtml(value) {
        const el = document.createElement('div');
        el.innerHTML = value || '';
        return (el.textContent || '').trim();
    }

    function getSummary(value) {
        const text = stripHtml(value);
        if (text.length <= SUMMARY_MAX_LENGTH) return text;
        return `${text.slice(0, SUMMARY_MAX_LENGTH)}...`;
    }

    function buildCard(item) {
        const mapped = mapCategory(item.category || 'other');
        const date = formatDate(item.updated_at || item.created_at);
        const attachmentUrl = normalizeAttachmentUrl(item.attachment_url || '');
        const pdfLink = attachmentUrl ? `<a class="pdf" href="${attachmentUrl}" target="_blank" rel="noopener"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M4 2h6l3 3v9H4V2Z" stroke="#ea580c" stroke-width="1.2"/><path d="M10 2v3h3" stroke="#ea580c" stroke-width="1.2"/><path d="M5.5 9.5h1m3 0H11M8 9.5V13" stroke="#ea580c" stroke-width="1.1" stroke-linecap="round"/></svg>PDF</a>` : '';
        return `
        <article class="card">
            <div class="card-header">
                <div>
                    <a class="card-title policy-link" data-id="${item.id || ''}" href="./PolicyDetail.html?id=${item.id || ''}">${item.title || 'Chưa có tiêu đề'}</a>
                    <div class="meta">
                        <span class="tag ${mapped.cls}">${mapped.text}</span>
                        <span>Ngày đăng: ${date}</span>
                        <span>Tác giả: ${item.issued_by || 'N/A'}</span>
                    </div>
                </div>
                <div class="card-actions">
                    ${pdfLink}
                    <a class="link policy-link" data-id="${item.id || ''}" href="./PolicyDetail.html?id=${item.id || ''}">Xem chi tiết</a>
                </div>
            </div>
            <p class="card-desc">${getSummary(item.summary || item.description || '')}</p>
        </article>`;
    }

    async function loadPolicies() {
        const token = getToken();
        if (!token) {
            window.location.href = '../Auth/Login.html';
            return;
        }
        listEl.innerHTML = '<div style="color:#64748b;">Đang tải dữ liệu...</div>';
        try {
            const res = await fetch(`${API_BASE_URL}/policies?limit=50`, {
                headers: { Authorization: `Bearer ${token}` },
            });
            if (res.status === 401) {
                localStorage.removeItem(TOKEN_STORAGE_KEY);
                sessionStorage.removeItem(TOKEN_STORAGE_KEY);
                window.location.href = '../Auth/Login.html';
                return;
            }
            if (!res.ok) throw new Error('Không tải được danh sách chính sách');
            policies = await res.json();
            // cache danh sách để detail có thể dùng fallback
            const cache = {};
            policies.forEach((p) => { if (p.id) cache[p.id] = p; });
            sessionStorage.setItem(POLICY_CACHE_KEY, JSON.stringify(cache));
            render(policies);
        } catch (error) {
            listEl.innerHTML = `<div style="color:#dc2626;">${error.message}</div>`;
        }
    }

    if (dropdownBtn && dropdownMenu) {
        dropdownBtn.addEventListener('click', (e) => { e.stopPropagation(); dropdownMenu.classList.toggle('open'); });
        dropdownMenu.addEventListener('click', (e) => {
            e.stopPropagation();
            if (e.target.dataset.action === 'logout') {
                localStorage.removeItem(TOKEN_STORAGE_KEY);
                sessionStorage.removeItem(TOKEN_STORAGE_KEY);
                window.location.href = '../Auth/Login.html';
            }
            if (e.target.dataset.action === 'change-password') window.location.href = '../Auth/ForgotPassword.html';
            dropdownMenu.classList.remove('open');
        });
        document.addEventListener('click', () => dropdownMenu.classList.remove('open'));
    }

    filterBtn.addEventListener('click', applyFilter);
    searchInput.addEventListener('keyup', event => { if (event.key === 'Enter') applyFilter(); });

    listEl.addEventListener('click', (e) => {
        const link = e.target.closest('.policy-link');
        if (!link) return;
        const id = link.dataset.id || new URL(link.href, window.location.href).searchParams.get('id');
        if (!id) return;
        sessionStorage.setItem(POLICY_SELECTED_KEY, id);
        e.preventDefault();
        window.location.href = `./PolicyDetail.html?id=${id}`;
    });

    loadPolicies();
</script>
<script>
(() => {
  const appShell = document.querySelector('.app-shell');
  const sidebar = document.querySelector('.sidebar');
  const toggle = document.querySelector('.menu-toggle');
  if (!appShell || !sidebar || !toggle) return;
  toggle.addEventListener('click', () => {
    const expanded = sidebar.classList.toggle('expanded');
    appShell.classList.toggle('menu-expanded', expanded);
  });
})();
</script>
</body>
</html>














